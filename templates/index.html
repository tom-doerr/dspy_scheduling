{% extends "base.html" %}

{% block content %}
<div class="nav">
    <a href="/" style="color: #fff;">Task List</a>
    <a href="/calendar">Timeline</a>
</div>

<div hx-get="/global-context" hx-trigger="load"></div>

<div class="section">
    <h2>Add New Task</h2>
    <form hx-post="/tasks" hx-target="#task-list" hx-swap="beforeend" id="add-task-form"
          hx-on::after-request="showToast('âœ“ Task added'); this.reset();">
        <input type="text" name="title" placeholder="Task title" required id="task-title-input" onkeydown="if(event.key==='Enter'){event.preventDefault();document.getElementById('add-task-form').dispatchEvent(new Event('submit',{bubbles:true,cancelable:true}));}">
        <textarea name="context" placeholder="Context (optional - e.g., priorities, constraints, preferences)" rows="3"></textarea>
        <button type="submit">Add Task</button>
    </form>
</div>

<div class="section">
    <h2>Tasks</h2>
    <button hx-post="/schedule" hx-target="#schedule-output">
        Run DSPy Scheduler
    </button>
    <div id="task-list" hx-get="/tasks" hx-trigger="load"></div>
</div>

<div id="schedule-output"></div>

<div hx-get="/inference-log" hx-trigger="load, every 10s"></div>
{% endblock %}
